# MATSimba by SBB [![](https://jitpack.io/v/SchweizerischeBundesbahnen/matsimba.svg)](https://jitpack.io/#SchweizerischeBundesbahnen/matsimba)


The following python libraries are provided by the [Swiss Federal Railways](http://www.sbb.ch/) (SBB, Schweizerische Bundesbahnen):


- [Analyse](#analyse)
- [Manager](#manager)
- [MAPY](#mapy)
- [VIMAPY](#vimapy)

<br />

To use the libraries, follow these steps:

<br />

 **Step 1**. Download and install [Python 2.7](https://www.python.org/download/releases/2.7/).


 **Step 2**. [Clone to repository](https://github.com/SchweizerischeBundesbahnen/matsim-sbb-extensions.git).

<br />

## Analyse <span id="analyse" />


The analysis library allows a fast and easy analysis of one or multiple [MATSim-run(s)](http://www.matsim.org/). It strongly depends on the output-files
generated by the postprocessing module in [matsim-sbb](https://github.com/SchweizerischeBundesbahnen/matsim-sbb). Use this
[runner](https://github.com/SchweizerischeBundesbahnen/matsim-sbb/blob/master/src/main/java/ch/sbb/matsim/analysis/RunSBBPostProcessing.java)
(takes a MATSim event file as input) to write all the files needed for the analysis library. A short demo shall explain the
standard usage ([Jupyter notebooks](http://jupyter.org/) recommended for this purpose):


**1**. Set path to python and MATSimba

```$python
import sys
sys.path.insert(0, r"path-to-python-site-packages")
sys.path.append(r"path-to-matsimby")
import glob
import os
import pandas as pd
%matplotlib inline
```

<br />

**2**. Import analyse

```$python
import analyse.run
import analyse.runs
import analyse.reference
import analyse.reporting
import analyse.variable
```

<br />

**3**. Create a new run list and append as much simulation runs as desired to the list

```$python
runs = analyse.runs.RunsList()
run = analyse.run.Run(r"path-to-outputs", name="reference", scale_factor=10, runId="CH.10pct.2015".replace("it.", ""))
runs.append(run)
secondRun = analyse.run.Run(r"path-to-outputs", name="variant", scale_factor=10, runId="CH.10pct.2015".replace("it.", ""))
runs.append(secondRun)
```

<br />

**4**. Load everything

```$python
runs.prepare()
```

<br />

**5**. You are now able to use the methods to analyze the runs defined in the run list. Examples:

```$python
df, fig = runs.plot_pkm_trips(by="main_mode", foreach=["subpopulation"])
```

```$python
df, fig = runs.plot_nb_trips(by="main_mode", foreach=["subpopulation"])
```

```$python
df, fig = runs.plot_pkm_distr_trips(foreach=["subpopulation", "main_mode"], percent=True, inverse_percent_axis=True,
    percent_level=["subpopulation"], rotate=True)
```

```$python
df, fig = runs.plot_einsteiger(by="stop_code", codes=["CF", "NE"],
    foreach=["subpopulation"])
```

```$python
df, fig = runs.plot_einsteiger(by="stop_code", codes=["CF", "NE"],
    foreach=["subpopulation"])
```

<br />

**6**. To write a standard excel report, use:

```$python
analyse.reporting.make_report(runs, r"report.xlsx")
```

<br />

## Manager <span id="manager" />

<br />

## MAPY <span id="mapy" />

@deprecated

<br />

## VIMAPY <span id="vimapy" />

